(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[333],{3212:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/user-settings",function(){return r(2220)}])},6977:(e,t,r)=>{"use strict";r.d(t,{$:()=>d,r:()=>o});var s=r(4848),a=r(6540),n=r(3362),l=r(6990),i=r(6094);let o=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,t)=>{let{className:r,variant:a,size:l,asChild:d=!1,...c}=e,u=d?n.DX:"button";return(0,s.jsx)(u,{className:(0,i.cn)(o({variant:a,size:l,className:r})),ref:t,...c})});d.displayName="Button"},355:(e,t,r)=>{"use strict";r.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>o,Zp:()=>l,aR:()=>i,wL:()=>u});var s=r(4848),a=r(6540),n=r(6094);let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});l.displayName="Card";let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...a})});i.displayName="CardHeader";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});o.displayName="CardTitle";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...a})});d.displayName="CardDescription";let c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...a})});c.displayName="CardContent";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...a})});u.displayName="CardFooter"},53:(e,t,r)=>{"use strict";r.d(t,{p:()=>l});var s=r(4848),a=r(6540),n=r(6094);let l=a.forwardRef((e,t)=>{let{className:r,type:a,...l}=e;return(0,s.jsx)("input",{type:a,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...l})});l.displayName="Input"},3427:(e,t,r)=>{"use strict";r.d(t,{J:()=>d});var s=r(4848),a=r(6540),n=r(5920),l=r(6990),i=r(6094);let o=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(n.b,{ref:t,className:(0,i.cn)(o(),r),...a})});d.displayName=n.b.displayName},5377:(e,t,r)=>{"use strict";r.d(t,{d:()=>i});var s=r(4848),a=r(6540),n=r(9014),l=r(6094);let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(n.bL,{className:(0,l.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",r),...a,ref:t,children:(0,s.jsx)(n.zi,{className:(0,l.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});i.displayName=n.bL.displayName},1659:(e,t,r)=>{"use strict";r.d(t,{T:()=>l});var s=r(4848),a=r(6540),n=r(6094);let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...a})});l.displayName="Textarea"},3229:(e,t,r)=>{"use strict";r.d(t,{Wn:()=>c,vz:()=>d,x$:()=>u});var s=r(4335),a=r(6715),n=r(5942);let l=async(e,t)=>{let r="http://localhost:3001/api/auth/login";if(!r)throw Error("Request URL is not defined");let{data:a}=await s.A.post(r,{email:e,password:t},{withCredentials:!0});return a},i=async()=>{let e="http://localhost:3001/api/auth/logout";if(!e)throw Error("Request URL is not defined");await s.A.delete(e,{withCredentials:!0})},o=async()=>{let e="http://localhost:3001/api/auth/session";if(!e)throw Error("Request URL is not defined");let{user:t}=(await s.A.get(e,{withCredentials:!0})).data;return console.log("fetch User:",t),t},d=()=>{let e=(0,a.useRouter)(),t=(0,n.useQueryClient)(),r=(0,n.useMutation)(e=>{let{email:t,password:r}=e;return l(t,r)},{onSuccess:r=>{let{user:s}=r;t.setQueryData(["sessionUser"],s),console.log("user query data:",s),e.push("/products")},onError:e=>{console.error("Login failed:",e),alert("Email or Password is invalid")}});return{login:(e,t)=>{r.mutate({email:e,password:t})},isLoading:r.isLoading}},c=()=>{let e=(0,a.useRouter)(),t=(0,n.useQueryClient)(),r=(0,n.useMutation)(i,{onSuccess:()=>{t.removeQueries(["sessionUser"]),e.push("/login")},onError:e=>{console.error("Logout failed:",e),alert("Failed to logout. Please try again.")}});return{logout:()=>{r.mutate()},isLoading:r.isLoading}},u=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.useQuery)(["sessionUser"],o,{...e,retry:!1,onError:e=>{console.error("Failed to fetch session:",e)}})}},6094:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n});var s=r(4164),a=r(856);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,s.$)(t))}},2220:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>ea});var s=r(4848),a=r(6540),n=r(8792),l=r(9785),i=r(4476),o=r(355),d=r(4514),c=r(6094);let u=d.bL,f=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(d.B8,{ref:t,className:(0,c.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",r),...a})});f.displayName=d.B8.displayName;let m=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(d.l9,{ref:t,className:(0,c.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",r),...a})});m.displayName=d.l9.displayName;let x=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(d.UC,{ref:t,className:(0,c.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",r),...a})});x.displayName=d.UC.displayName;var h=r(5847);let p=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(h.bL,{ref:t,className:(0,c.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...a})});p.displayName=h.bL.displayName;let g=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(h._V,{ref:t,className:(0,c.cn)("aspect-square h-full w-full",r),...a})});g.displayName=h._V.displayName;let b=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(h.H4,{ref:t,className:(0,c.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",r),...a})});b.displayName=h.H4.displayName;var j=r(5377),v=r(6977),y=r(3362),N=r(3427);let w=l.Op,R=a.createContext({}),C=e=>{let{...t}=e;return(0,s.jsx)(R.Provider,{value:{name:t.name},children:(0,s.jsx)(l.xI,{...t})})},k=()=>{let e=a.useContext(R),t=a.useContext(L),{getFieldState:r,formState:s}=(0,l.xW)(),n=r(e.name,s);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=t;return{id:i,name:e.name,formItemId:"".concat(i,"-form-item"),formDescriptionId:"".concat(i,"-form-item-description"),formMessageId:"".concat(i,"-form-item-message"),...n}},L=a.createContext({}),E=a.forwardRef((e,t)=>{let{className:r,...n}=e,l=a.useId();return(0,s.jsx)(L.Provider,{value:{id:l},children:(0,s.jsx)("div",{ref:t,className:(0,c.cn)("space-y-2",r),...n})})});E.displayName="FormItem";let _=a.forwardRef((e,t)=>{let{className:r,...a}=e,{error:n,formItemId:l}=k();return(0,s.jsx)(N.J,{ref:t,className:(0,c.cn)(n&&"text-destructive",r),htmlFor:l,...a})});_.displayName="FormLabel";let U=a.forwardRef((e,t)=>{let{...r}=e,{error:a,formItemId:n,formDescriptionId:l,formMessageId:i}=k();return(0,s.jsx)(y.DX,{ref:t,id:n,"aria-describedby":a?"".concat(l," ").concat(i):"".concat(l),"aria-invalid":!!a,...r})});U.displayName="FormControl";let F=a.forwardRef((e,t)=>{let{className:r,...a}=e,{formDescriptionId:n}=k();return(0,s.jsx)("p",{ref:t,id:n,className:(0,c.cn)("text-sm text-muted-foreground",r),...a})});F.displayName="FormDescription";let D=a.forwardRef((e,t)=>{let{className:r,children:a,...n}=e,{error:l,formMessageId:i}=k(),o=l?String(null==l?void 0:l.message):a;return o?(0,s.jsx)("p",{ref:t,id:i,className:(0,c.cn)("text-sm font-medium text-destructive",r),...n,children:o}):null});D.displayName="FormMessage";let A=e=>{let{form:t,handleSubmit:r}=e;return(0,s.jsx)(w,{...t,children:(0,s.jsxs)("form",{onSubmit:r,className:"space-y-8",children:[(0,s.jsx)(C,{control:t.control,name:"emailNotifications",render:e=>{let{field:t}=e;return(0,s.jsxs)(E,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsx)(_,{className:"text-base",children:"メール通知"}),(0,s.jsx)(F,{children:"重要な更新をメールで受け取ります。"})]}),(0,s.jsx)(U,{children:(0,s.jsx)(j.d,{checked:t.value,onCheckedChange:t.onChange})})]})}}),(0,s.jsx)(C,{control:t.control,name:"pushNotifications",render:e=>{let{field:t}=e;return(0,s.jsxs)(E,{className:"flex flex-row items-center justify-between rounded-lg border p-4",children:[(0,s.jsxs)("div",{className:"space-y-0.5",children:[(0,s.jsx)(_,{className:"text-base",children:"プッシュ通知"}),(0,s.jsx)(F,{children:"アプリからのプッシュ通知を受け取ります。"})]}),(0,s.jsx)(U,{children:(0,s.jsx)(j.d,{checked:t.value,onCheckedChange:t.onChange})})]})}}),(0,s.jsx)(v.$,{type:"submit",children:"保存"})]})})};var S=r(53),I=r(1659);let z=e=>{let{form:t,isEditing:r,setIsEditing:a,handleSubmit:n}=e;return(0,s.jsx)(w,{...t,children:(0,s.jsxs)("form",{onSubmit:n,className:"space-y-8",children:[(0,s.jsx)(C,{control:t.control,name:"name",render:e=>{let{field:t}=e;return(0,s.jsxs)(E,{children:[(0,s.jsx)(_,{children:"名前"}),(0,s.jsx)(U,{children:(0,s.jsx)(S.p,{...t,disabled:!r})}),(0,s.jsx)(D,{})]})}}),(0,s.jsx)(C,{control:t.control,name:"email",render:e=>{let{field:t}=e;return(0,s.jsxs)(E,{children:[(0,s.jsx)(_,{children:"メールアドレス"}),(0,s.jsx)(U,{children:(0,s.jsx)(S.p,{...t,disabled:!r})}),(0,s.jsx)(D,{})]})}}),(0,s.jsx)(C,{control:t.control,name:"bio",render:e=>{let{field:t}=e;return(0,s.jsxs)(E,{children:[(0,s.jsx)(_,{children:"自己紹介"}),(0,s.jsx)(U,{children:(0,s.jsx)(I.T,{...t,disabled:!r})}),(0,s.jsx)(F,{children:"160文字以内で自己紹介を書いてください。"}),(0,s.jsx)(D,{})]})}}),r?(0,s.jsx)(v.$,{type:"submit",children:"保存"}):(0,s.jsx)(v.$,{type:"button",onClick:()=>a(!0),children:"編集"})]})})};var P=r(3229),T=r(847);let Q=T.bL,B=T.l9,$=T.ZL,M=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(T.hJ,{className:(0,c.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...a,ref:t})});M.displayName=T.hJ.displayName;let V=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsxs)($,{children:[(0,s.jsx)(M,{}),(0,s.jsx)(T.UC,{ref:t,className:(0,c.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...a})]})});V.displayName=T.UC.displayName;let Z=e=>{let{className:t,...r}=e;return(0,s.jsx)("div",{className:(0,c.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...r})};Z.displayName="AlertDialogHeader";let Y=e=>{let{className:t,...r}=e;return(0,s.jsx)("div",{className:(0,c.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...r})};Y.displayName="AlertDialogFooter";let q=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(T.hE,{ref:t,className:(0,c.cn)("text-lg font-semibold",r),...a})});q.displayName=T.hE.displayName;let W=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(T.VY,{ref:t,className:(0,c.cn)("text-sm text-muted-foreground",r),...a})});W.displayName=T.VY.displayName;let X=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(T.rc,{ref:t,className:(0,c.cn)((0,v.r)(),r),...a})});X.displayName=T.rc.displayName;let H=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(T.ZD,{ref:t,className:(0,c.cn)((0,v.r)({variant:"outline"}),"mt-2 sm:mt-0",r),...a})});H.displayName=T.ZD.displayName;let J=()=>{let{logout:e}=(0,P.Wn)();return(0,s.jsxs)(Q,{children:[(0,s.jsx)(B,{asChild:!0,children:(0,s.jsx)(v.$,{variant:"outline",className:"w-full",children:"Logout"})}),(0,s.jsxs)(V,{children:[(0,s.jsxs)(Z,{children:[(0,s.jsx)(q,{children:"Are you sure you want to log out?"}),(0,s.jsx)(W,{children:"Logging out will prevent access to your account until you log back in."})]}),(0,s.jsxs)(Y,{children:[(0,s.jsx)(H,{children:"Cancel"}),(0,s.jsx)(X,{onClick:e,children:"Log out"})]})]})]})},O=()=>(0,s.jsxs)(Q,{children:[(0,s.jsx)(B,{asChild:!0,children:(0,s.jsx)(v.$,{variant:"destructive",className:"w-full",children:"Delete Account"})}),(0,s.jsxs)(V,{children:[(0,s.jsxs)(Z,{children:[(0,s.jsx)(q,{children:"Are you sure you want to delete your account?"}),(0,s.jsx)(W,{children:"This action cannot be undone. Deleting your account will permanently remove all your data."})]}),(0,s.jsxs)(Y,{children:[(0,s.jsx)(H,{children:"Cancel"}),(0,s.jsx)(X,{className:"bg-destructive text-destructive-foreground",children:"Delete Account"})]})]})]});var G=r(5942),K=r(4335),ee=r(7836);let et=()=>{let e=(0,G.useQueryClient)();return(0,G.useMutation)(async e=>{let t=ee.env.NEXT_PUBLIC_API_UPDATE_USER_URL;return console.log("Updating user with data:",e),(await K.A.patch("".concat(t,"/").concat(e.id),e)).data},{onSuccess:()=>{e.invalidateQueries("sessionUser")}})},er=i.Ik({name:i.Yj().min(2,"Name must be at least 2 characters long"),email:i.Yj().email("Please enter a valid email address"),bio:i.Yj().max(160,"Bio must be within 160 characters").nullable(),avatar:i.Yj().optional(),emailNotifications:i.zM(),pushNotifications:i.zM()}),es=e=>{let{user:t}=e,[r,i]=(0,a.useState)(!1),d=et(),c=(0,l.mN)({resolver:(0,n.u)(er),defaultValues:t}),h=c.handleSubmit(e=>{var t,r;let s={name:e.name,email:e.email,bio:null!==(t=e.bio)&&void 0!==t?t:void 0,avatar:null!==(r=e.avatar)&&void 0!==r?r:void 0,emailNotifications:e.emailNotifications,pushNotifications:e.pushNotifications};d.mutate(s,{onSuccess:()=>{i(!1),console.log("User updated successfully")},onError:e=>{console.error("Failed to update user:",e)}})});return(0,s.jsx)("div",{className:"container mx-auto py-10",children:(0,s.jsxs)(o.Zp,{className:"max-w-2xl mx-auto",children:[(0,s.jsx)(o.aR,{children:(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)(p,{className:"w-20 h-20",children:[(0,s.jsx)(g,{src:t.avatar||"",alt:t.name}),(0,s.jsx)(b,{children:t.name.slice(0,2)})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(o.ZB,{className:"text-2xl",children:[t.name," Settings"]}),(0,s.jsx)(o.BT,{children:"Manage account and notification settings"})]})]})}),(0,s.jsx)(o.Wu,{children:(0,s.jsxs)(u,{defaultValue:"account",children:[(0,s.jsxs)(f,{className:"grid w-full grid-cols-2 border-b",children:[(0,s.jsx)(m,{value:"account",className:"p-2 hover:bg-gray-100 focus:ring-2 ring-blue-500",children:"Account"}),(0,s.jsx)(m,{value:"notifications",className:"p-2 hover:bg-gray-100 focus:ring-2 ring-blue-500",children:"Notifications"})]}),(0,s.jsxs)(x,{value:"account",children:[(0,s.jsx)(z,{form:c,isEditing:r,setIsEditing:i,handleSubmit:h}),(0,s.jsxs)("div",{className:"mt-8 space-y-4",children:[(0,s.jsx)(J,{}),(0,s.jsx)(O,{})]})]}),(0,s.jsx)(x,{value:"notifications",children:(0,s.jsx)(A,{form:c,handleSubmit:h})})]})})]})})},ea=()=>{let e=(0,G.useQueryClient)().getQueryData("sessionUser"),{data:t,isLoading:r,isError:a}=(0,P.x$)({enabled:!e});if(!e&&r)return(0,s.jsx)("div",{children:"Loading..."});if(a)return(0,s.jsx)("div",{children:"Error loading user data."});let n=e||t;return(console.log(n),n)?(0,s.jsx)("div",{children:(0,s.jsx)(es,{user:n})}):(0,s.jsx)("div",{children:"No user data available."})}}},e=>{var t=t=>e(e.s=t);e.O(0,[335,801,916,912,739,476,337,636,593,792],()=>t(3212)),_N_E=e.O()}]);